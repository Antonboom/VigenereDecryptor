!function(){function b(){for(var b=document.getElementsByClassName("js-show-more"),c=0;c<b.length;c++)b[c].removeEventListener("click",a,!1),b[c].addEventListener("click",a,!1)}var a=function(a){a.preventDefault();var b=document.getElementById(this.dataset.hidden);b.classList.toggle("hidden")};b();var c=document.getElementById("vigenereForm");c.addEventListener("submit",function(a){a.preventDefault();var d=document.getElementById("solution");d.innerHTML='<img src="/static/images/loader.gif" width="50" height="50">';var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState==XMLHttpRequest.DONE)if(200==e.status){var a=JSON.parse(e.responseText);if("error"in a)return void(d.innerHTML='<br><b>Ошибка сервера: "'+a.error+'"</b>');d.innerHTML="";var c=a.is_vigenere,f=a.keys;if(c===!1)f.forEach(function(a){d.innerHTML+="<p><b>"+a.value+"</b><br>"+a.decrypt_text+"</p>"});else{var g=a.key_mask,h=a.key_length,i=a.key_lengths,j=a.key_symbols_candidates;d.innerHTML="<p>Найденная длина ключа: <b>"+h+'</b>  - <span class="js-show-more" data-hidden="lengths-solutions">Решение</span></p>',d.innerHTML+='<div id="lengths-solutions" class="hidden"></div>';var k=document.getElementById("lengths-solutions");for(var l in i)if(i.hasOwnProperty(l)){var m="length-solution-"+l;k.innerHTML+="<p>Длина ключа "+l+'<br><span class="js-show-more" data-hidden="'+m+'">Количество округлений '+i[l].roundings_count+"</span>",k.innerHTML+='<pre id="'+m+'" class="hidden"></pre>';var n=document.getElementById(m);n.innerHTML+="<span>(грамма - расстояния - округление до размера ключа - количество округлений)</span>",i[l].gramms.forEach(function(a){n.innerHTML+="<p>"+a+"</p>"})}d.innerHTML+="<p>Получившийся ключ: <b>"+g+'</b> - <span class="js-show-more" data-hidden="symbols-solutions">Решение</span></p>',d.innerHTML+='<div id="symbols-solutions" class="hidden"></div>';var o=document.getElementById("symbols-solutions");j.forEach(function(a,b){var c=a.candidates,d=a.repeats,e=a.columns,f="symbol-solutions-"+b+1;o.innerHTML+='<p class="js-show-more" data-hidden="'+f+'">Кандидаты на звание "'+(b+1)+' символ ключа": '+c+"</p>",o.innerHTML+='<table id="'+f+'" class="hidden"></table>';var g=document.getElementById(f);g.innerHTML+='<thead><tr><td colspan="3">Повторения символов на '+(b+1)+" позиции в тексте: "+d+"</td></tr></thead>";var h;e.forEach(function(a,b){0==b?h="<tr>":b%3==0&&(h+="</tr><tr>"),h+="<td><pre>"+a+"</pre></td>"}),h+="</tr>",g.innerHTML+=h}),d.innerHTML+="<p>Ключи из словаря, удовлетворяющие найденной маске:</p>",f.forEach(function(a){d.innerHTML+="<p><b>"+a.value+"</b><br>"+a.decrypt_text+"</p>"}),0===f.length&&(d.innerHTML+="<b>отсуствуют</b>")}b()}else d.innerHTML="<br><b>Неопознанная ошибка сервера :(</b>"},e.open("POST","/vigenere",!0),e.send(new FormData(c))})}();